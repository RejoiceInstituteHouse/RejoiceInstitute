<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rejoice Institute House | Dashboard</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <div class="logo">
                    <a href="../index.html">REJOICE INSTITUTE HOUSE</a>
                </div>
                <ul class="nav-links">
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="books.html">Books</a></li>
                    <li><a href="hub.html">Hub</a></li>
                    <li><a href="dashboard.html" class="active">Dashboard</a></li>
                </ul>
                <div class="auth-buttons">
                    <span class="user-welcome">Loading...</span>
                    <a href="#" class="btn btn-login" onclick="logout()">Logout</a>
                </div>
            </nav>
        </div>
    </header>

    <main class="container">
        <div class="dashboard-loader">
            <div class="loader-content">
                <h1>Loading Your Dashboard</h1>
                <p>Taking you to your personalized workspace...</p>
                <div class="loading-spinner"></div>
            </div>
        </div>
    </main>

    <script>
        // Simulate user detection - in real app, this would come from backend
        function getUserRole() {
            // For demo purposes, we'll use localStorage
            // In real app, this would be from login session
            const savedRole = localStorage.getItem('userRole');
            if (savedRole) {
                return savedRole;
            }
            
            // Default to reader for demo
            return 'reader';
        }

        function redirectToDashboard() {
            const userRole = getUserRole();
            const dashboards = {
                'reader': 'dashboard-reader.html',
                'author': 'dashboard-author.html',
                'artist': 'dashboard-artist.html',
                'admin': 'dashboard-admin.html'
            };
            
            setTimeout(() => {
                window.location.href = dashboards[userRole] || 'dashboard-reader.html';
            }, 1500);
        }

        // In dashboard-reader.html, dashboard-author.html, etc. replace the logout function with:
        function logout() {
        if (typeof Auth !== 'undefined') {
        Auth.logoutAndRedirect();
        } else {
        // Fallback to localStorage cleanup
        localStorage.removeItem('currentUser');
        window.location.href = 'login.html';
        }
        }

        // Update welcome message
        document.addEventListener('DOMContentLoaded', function() {
            const userRole = getUserRole();
            const roleNames = {
                'reader': 'Reader',
                'author': 'Author',
                'artist': 'Artist',
                'admin': 'Administrator'
            };
            
            document.querySelector('.user-welcome').textContent = `Welcome, ${roleNames[userRole]}!`;
            redirectToDashboard();
        });
    </script>

    <style>
        .dashboard-loader {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 60vh;
            text-align: center;
        }

        .loader-content h1 {
            color: var(--color-black);
            margin-bottom: 1rem;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--color-khaki);
            border-top: 4px solid var(--color-purple);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 2rem auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    <!-- Add these BEFORE your script.js -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="firebase-config.js"></script>
<script src="script.js"></script>
</body>
</html>